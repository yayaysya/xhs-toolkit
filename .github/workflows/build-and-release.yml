name: ğŸš€ æ„å»ºå’Œå‘å¸ƒå°çº¢ä¹¦MCPå·¥å…·åŒ…

on:
  # æ‰‹åŠ¨è§¦å‘å·¥ä½œæµ
  workflow_dispatch:
    inputs:
      version:
        description: 'xhs_toolkit:v1.0.2'
        required: true
        default: 'v1.0.2'
        type: string
      release_type:
        description: 'å‘å¸ƒç±»å‹'
        required: true
        default: 'patch'
        type: choice
        options:
        - patch   # ä¿®å¤ç‰ˆæœ¬ (1.0.1 -> 1.0.2)
        - minor   # åŠŸèƒ½ç‰ˆæœ¬ (1.0.0 -> 1.1.0)
        - major   # é‡å¤§ç‰ˆæœ¬ (1.0.0 -> 2.0.0)
      release_notes:
        description: 'å‘å¸ƒè¯´æ˜ï¼ˆå¯é€‰ï¼Œå°†è¿½åŠ åˆ°è‡ªåŠ¨ç”Ÿæˆçš„è¯´æ˜åï¼‰'
        required: false
        default: ''
        type: string
  
  # æ¨é€æ ‡ç­¾æ—¶ä¹Ÿè§¦å‘ï¼ˆå¤‡ç”¨æ–¹å¼ï¼‰
  push:
    tags:
      - 'v*'

env:
  PYTHON_VERSION: '3.12'

jobs:
  # ============================================
  # ä»£ç è´¨é‡æ£€æŸ¥
  # ============================================
  lint-and-test:
    name: ğŸ” ä»£ç è´¨é‡æ£€æŸ¥
    runs-on: ubuntu-latest
    
    steps:
    - name: ğŸ“¥ æ£€å‡ºä»£ç 
      uses: actions/checkout@v4
      
    - name: ğŸ è®¾ç½®Pythonç¯å¢ƒ
      uses: actions/setup-python@v5
      with:
        python-version: ${{ env.PYTHON_VERSION }}
        cache: 'pip'
        
    - name: ğŸ“¦ å®‰è£…ä¾èµ–
      run: |
        python -m pip install --upgrade pip
        pip install -r requirements.txt
        pip install flake8 pytest
        
    - name: ğŸ” ä»£ç é£æ ¼æ£€æŸ¥
      run: |
        # è·³è¿‡é•¿è¡Œå’Œä¸€äº›å¸¸è§è­¦å‘Š
        flake8 . --count --select=E9,F63,F7,F82 --show-source --statistics \
          --exclude=__pycache__,*.pyc,build,dist
        
    - name: âœ… è¯­æ³•æ£€æŸ¥
      run: |
        # æ£€æŸ¥ä¸»å…¥å£æ–‡ä»¶
        python -m py_compile xhs_toolkit.py
        
        # æ£€æŸ¥srcç›®å½•ä¸‹çš„æ‰€æœ‰Pythonæ–‡ä»¶
        find src/ -name "*.py" -type f | while read file; do
          echo "æ£€æŸ¥æ–‡ä»¶: $file"
          python -m py_compile "$file"
        done
        
    - name: ğŸ§ª æ¨¡å—å¯¼å…¥æµ‹è¯•
      run: |
        # æµ‹è¯•å…³é”®æ¨¡å—å¯¼å…¥
        python -c "
        import sys
        sys.path.insert(0, '.')
        
        # æµ‹è¯•æ ¸å¿ƒæ¨¡å—
        from src.core.config import XHSConfig
        from src.core.exceptions import XHSToolkitError
        from src.core.browser import ChromeDriverManager
        
        # æµ‹è¯•è®¤è¯æ¨¡å—
        from src.auth.cookie_manager import CookieManager
        
        # æµ‹è¯•å·¥å…·æ¨¡å—
        from src.utils.logger import get_logger
        from src.utils.text_utils import safe_print
        
        # æµ‹è¯•å°çº¢ä¹¦æ¨¡å—
        from src.xiaohongshu.models import XHSNote
        from src.xiaohongshu.client import XHSClient
        
        # æµ‹è¯•æœåŠ¡å™¨æ¨¡å—
        from src.server.mcp_server import MCPServer
        
        print('âœ… æ‰€æœ‰æ¨¡å—å¯¼å…¥æˆåŠŸ')
        "

  # ============================================
  # å¤šå¹³å°æ„å»º
  # ============================================
  build:
    name: ğŸ”¨ æ„å»º ${{ matrix.os }}
    needs: lint-and-test
    runs-on: ${{ matrix.os }}
    
    strategy:
      fail-fast: false
      matrix:
        include:
          - os: ubuntu-latest
            platform: linux
            arch: x64
            binary_name: xhs-toolkit-linux-x64
            setup_cmd: |
              sudo apt-get update
              sudo apt-get install -y wget unzip xvfb
              
          - os: windows-latest  
            platform: windows
            arch: x64
            binary_name: xhs-toolkit-windows-x64.exe
            setup_cmd: |
              # Windowså¹³å°æš‚ä¸å®‰è£…Chromeï¼ˆç”¨æˆ·è‡ªè¡Œå®‰è£…ï¼‰
              echo "Windows platform setup"
              
          - os: macos-latest
            platform: macos
            arch: x64  
            binary_name: xhs-toolkit-macos-x64
            setup_cmd: |
              # macOSå¹³å°æš‚ä¸å®‰è£…Chromeï¼ˆç”¨æˆ·è‡ªè¡Œå®‰è£…ï¼‰
              echo "macOS platform setup"
    
    steps:
    - name: ğŸ“¥ æ£€å‡ºä»£ç 
      uses: actions/checkout@v4
      
    - name: ğŸ è®¾ç½®Pythonç¯å¢ƒ  
      uses: actions/setup-python@v5
      with:
        python-version: ${{ env.PYTHON_VERSION }}
        cache: 'pip'
        
    - name: ğŸ”§ å¹³å°ç‰¹å®šè®¾ç½®
      run: ${{ matrix.setup_cmd }}
      shell: bash
      
    - name: ğŸ“¦ å®‰è£…Pythonä¾èµ–
      run: |
        python -m pip install --upgrade pip
        pip install -r requirements.txt
        pip install pyinstaller
        
    - name: ğŸ”¨ æ„å»ºå¯æ‰§è¡Œæ–‡ä»¶
      run: |
        # ä½¿ç”¨specæ–‡ä»¶æ„å»ºï¼Œæä¾›æ›´å¥½çš„æ§åˆ¶
        pyinstaller \
          --clean \
          --noconfirm \
          --onefile \
          --console \
          --name ${{ matrix.binary_name }} \
          .github/xhs_toolkit.spec
        
        # é‡å‘½åç”Ÿæˆçš„æ–‡ä»¶
        if [ -f "dist/xhs-toolkit" ]; then
          mv dist/xhs-toolkit dist/${{ matrix.binary_name }}
        elif [ -f "dist/xhs-toolkit.exe" ]; then
          mv dist/xhs-toolkit.exe dist/${{ matrix.binary_name }}
        fi
      shell: bash
      
    - name: ğŸ” æ£€æŸ¥æ„å»ºç»“æœ
      run: |
        echo "ğŸ“ æ„å»ºç›®å½•ç»“æ„:"
        find dist/ -type f
        echo "ğŸ“¦ å¯æ‰§è¡Œæ–‡ä»¶ä¿¡æ¯:"
        ls -la dist/
      shell: bash
      
    - name: ğŸ“¤ ä¸Šä¼ æ„å»ºäº§ç‰©
      uses: actions/upload-artifact@v4
      with:
        name: ${{ matrix.binary_name }}
        path: |
          dist/${{ matrix.binary_name }}*
          env_example
          README.md
          LICENSE
        retention-days: 7

  # ============================================
  # åˆ›å»ºå‘å¸ƒç‰ˆæœ¬
  # ============================================
  release:
    name: ğŸ‰ åˆ›å»ºRelease
    needs: build
    runs-on: ubuntu-latest
    if: github.event_name == 'workflow_dispatch' || startsWith(github.ref, 'refs/tags/v')
    
    steps:
    - name: ğŸ“¥ æ£€å‡ºä»£ç 
      uses: actions/checkout@v4
      with:
        fetch-depth: 0  # è·å–å®Œæ•´å†å²è®°å½•ï¼Œç”¨äºç”Ÿæˆæ›´æ–°æ—¥å¿—
    
    - name: ğŸ·ï¸ è®¾ç½®ç‰ˆæœ¬ä¿¡æ¯
      id: version
      run: |
        if [ "${{ github.event_name }}" = "workflow_dispatch" ]; then
          VERSION="${{ github.event.inputs.version }}"
          RELEASE_TYPE="${{ github.event.inputs.release_type }}"
        else
          VERSION="${{ github.ref_name }}"
          RELEASE_TYPE="patch"
        fi
        
        echo "version=${VERSION}" >> $GITHUB_OUTPUT
        echo "release_type=${RELEASE_TYPE}" >> $GITHUB_OUTPUT
        echo "version_no_v=${VERSION#v}" >> $GITHUB_OUTPUT
      
    - name: ğŸ“¥ ä¸‹è½½æ‰€æœ‰æ„å»ºäº§ç‰©
      uses: actions/download-artifact@v4
      with:
        path: artifacts/
        
    - name: ğŸ“¦ æ‰“åŒ…å‘å¸ƒæ–‡ä»¶
      run: |
        mkdir -p release/
        
        # æ£€æŸ¥ä¸‹è½½çš„artifactç»“æ„
        echo "ğŸ“‹ Artifactç»“æ„æ£€æŸ¥:"
        find artifacts/ -type f | head -20
        
        # ä¸ºæ¯ä¸ªå¹³å°åˆ›å»ºå‹ç¼©åŒ…
        cd artifacts/
        
        # Linux
        if [ -d "xhs-toolkit-linux-x64" ]; then
          mkdir -p linux-package
          # æŸ¥æ‰¾Linuxå¯æ‰§è¡Œæ–‡ä»¶
          if [ -f "xhs-toolkit-linux-x64/dist/xhs-toolkit-linux-x64" ]; then
            cp xhs-toolkit-linux-x64/dist/xhs-toolkit-linux-x64 linux-package/xhs-toolkit
          elif [ -f "xhs-toolkit-linux-x64/xhs-toolkit-linux-x64" ]; then
            cp xhs-toolkit-linux-x64/xhs-toolkit-linux-x64 linux-package/xhs-toolkit
          else
            echo "âŒ Linuxå¯æ‰§è¡Œæ–‡ä»¶æœªæ‰¾åˆ°"
            find xhs-toolkit-linux-x64/ -name "*linux*" -type f
          fi
          cp xhs-toolkit-linux-x64/{env_example,README.md,LICENSE} linux-package/ 2>/dev/null || true
          tar -czf ../release/xhs-toolkit-linux-x64.tar.gz -C linux-package .
        fi
        
        # Windows  
        if [ -d "xhs-toolkit-windows-x64.exe" ]; then
          mkdir -p windows-package
          # æŸ¥æ‰¾Windowså¯æ‰§è¡Œæ–‡ä»¶
          if [ -f "xhs-toolkit-windows-x64.exe/dist/xhs-toolkit-windows-x64.exe" ]; then
            cp xhs-toolkit-windows-x64.exe/dist/xhs-toolkit-windows-x64.exe windows-package/xhs-toolkit.exe
          elif [ -f "xhs-toolkit-windows-x64.exe/xhs-toolkit-windows-x64.exe" ]; then
            cp xhs-toolkit-windows-x64.exe/xhs-toolkit-windows-x64.exe windows-package/xhs-toolkit.exe
          else
            echo "âŒ Windowså¯æ‰§è¡Œæ–‡ä»¶æœªæ‰¾åˆ°"
            find xhs-toolkit-windows-x64.exe/ -name "*windows*" -type f
          fi
          cp xhs-toolkit-windows-x64.exe/{env_example,README.md,LICENSE} windows-package/ 2>/dev/null || true
          cd windows-package && zip -r ../../release/xhs-toolkit-windows-x64.zip . && cd ..
        fi
        
        # macOS
        if [ -d "xhs-toolkit-macos-x64" ]; then
          mkdir -p macos-package  
          # æŸ¥æ‰¾macOSå¯æ‰§è¡Œæ–‡ä»¶
          if [ -f "xhs-toolkit-macos-x64/dist/xhs-toolkit-macos-x64" ]; then
            cp xhs-toolkit-macos-x64/dist/xhs-toolkit-macos-x64 macos-package/xhs-toolkit
          elif [ -f "xhs-toolkit-macos-x64/xhs-toolkit-macos-x64" ]; then
            cp xhs-toolkit-macos-x64/xhs-toolkit-macos-x64 macos-package/xhs-toolkit
          else
            echo "âŒ macOSå¯æ‰§è¡Œæ–‡ä»¶æœªæ‰¾åˆ°"
            find xhs-toolkit-macos-x64/ -name "*macos*" -type f
          fi
          cp xhs-toolkit-macos-x64/{env_example,README.md,LICENSE} macos-package/ 2>/dev/null || true
          tar -czf ../release/xhs-toolkit-macos-x64.tar.gz -C macos-package .
        fi
        
        cd ../
        echo "ğŸ“¦ æœ€ç»ˆå‘å¸ƒæ–‡ä»¶:"
        ls -la release/
        
    - name: ğŸ“ ç”Ÿæˆå‘å¸ƒè¯´æ˜
      id: release_notes
      run: |
        VERSION="${{ steps.version.outputs.version }}"
        RELEASE_TYPE="${{ steps.version.outputs.release_type }}"
        VERSION_NO_V="${{ steps.version.outputs.version_no_v }}"
        
        # æ ¹æ®ç‰ˆæœ¬ç”Ÿæˆç‰¹å®šçš„æ›´æ–°è¯´æ˜
        if [ "${VERSION_NO_V}" = "1.0.2" ]; then
          cat > release-notes.md << 'EOF'
        ## ğŸŒº å°çº¢ä¹¦MCPå·¥å…·åŒ… v1.0.2
        
        > ğŸ—ï¸ **é‡æ„ç‰ˆæœ¬** - å…¨é¢é‡æ„ä¸ºä¼ä¸šçº§æ¡†æ¶ç»“æ„
        
        ### ğŸ¯ é‡å¤§é‡æ„
        
        - **ğŸ—ï¸ æ¨¡å—åŒ–é‡æ„**: æŒ‰ç…§SOLIDåŸåˆ™é‡æ„ä»£ç ç»“æ„ï¼Œæå‡å¯ç»´æŠ¤æ€§å’Œæ‰©å±•æ€§
        - **ğŸ“ æ–°ç›®å½•ç»“æ„**: é‡‡ç”¨æ ‡å‡†çš„src/ç›®å½•ç»“æ„ï¼Œæ¨¡å—èŒè´£æ›´æ¸…æ™°
        - **ğŸ”§ ç»Ÿä¸€å¼‚å¸¸å¤„ç†**: å®ç°ç»Ÿä¸€çš„é”™è¯¯å¤„ç†è¾¹ç•Œç»„ä»¶
        - **âš¡ æ€§èƒ½ä¼˜åŒ–**: å¼‚æ­¥å¤„ç†ã€èµ„æºç®¡ç†ã€å†…å­˜ä¼˜åŒ–
        
        ### ğŸ“‚ æ–°æ¶æ„ç‰¹æ€§
        
        ```
        xhs-toolkit/
        â”œâ”€â”€ xhs_toolkit.py              # ğŸš€ ä¸»å…¥å£ï¼ˆç»Ÿä¸€CLIï¼‰
        â”œâ”€â”€ src/                        # ğŸ“ æºä»£ç ç›®å½•
        â”‚   â”œâ”€â”€ core/                   # ğŸ”§ æ ¸å¿ƒåŠŸèƒ½
        â”‚   â”‚   â”œâ”€â”€ config.py          # é…ç½®ç®¡ç†
        â”‚   â”‚   â”œâ”€â”€ browser.py         # æµè§ˆå™¨ç®¡ç†  
        â”‚   â”‚   â””â”€â”€ exceptions.py      # å¼‚å¸¸å¤„ç†
        â”‚   â”œâ”€â”€ auth/                   # ğŸ” è®¤è¯æ¨¡å—
        â”‚   â”‚   â””â”€â”€ cookie_manager.py  # Cookieç®¡ç†
        â”‚   â”œâ”€â”€ xiaohongshu/           # ğŸŒº å¹³å°åŠŸèƒ½
        â”‚   â”‚   â”œâ”€â”€ models.py          # æ•°æ®æ¨¡å‹
        â”‚   â”‚   â””â”€â”€ client.py          # å°çº¢ä¹¦å®¢æˆ·ç«¯
        â”‚   â”œâ”€â”€ server/                # ğŸ–¥ï¸ MCPæœåŠ¡å™¨
        â”‚   â”‚   â””â”€â”€ mcp_server.py      # MCPæœåŠ¡å™¨
        â”‚   â””â”€â”€ utils/                 # ğŸ› ï¸ å·¥å…·å‡½æ•°
        â”‚       â”œâ”€â”€ logger.py          # æ—¥å¿—ç³»ç»Ÿ
        â”‚       â””â”€â”€ text_utils.py      # æ–‡æœ¬å¤„ç†
        ```
        
        ### âœ¨ æ–°å¢åŠŸèƒ½
        
        - **ğŸ”§ é…ç½®ç®¡ç†**: æ–°å¢é…ç½®æ˜¾ç¤ºã€éªŒè¯ã€ç¤ºä¾‹ç”ŸæˆåŠŸèƒ½
        - **ğŸ“Š ç³»ç»ŸçŠ¶æ€**: å®Œæ•´çš„ç³»ç»ŸçŠ¶æ€æ£€æŸ¥å’Œè¯Šæ–­
        - **ğŸ› ï¸ å·¥å…·å‡½æ•°**: ç»Ÿä¸€çš„æ–‡æœ¬å¤„ç†å’Œæ—¥å¿—ç³»ç»Ÿ
        - **ğŸ”Œ ç¼–ç¨‹æ¥å£**: æ¨¡å—åŒ–çš„APIï¼Œä¾¿äºäºŒæ¬¡å¼€å‘
        - **ğŸŒ è·¨å¹³å°å…¼å®¹**: æ”¹è¿›çš„Windows/macOS/Linuxå…¼å®¹æ€§
        
        ### ğŸ”„ å‘åå…¼å®¹
        
        - âœ… **CLIå‘½ä»¤ä¿æŒä¸€è‡´**: æ‰€æœ‰åŸæœ‰å‘½ä»¤ç»§ç»­å¯ç”¨
        - âœ… **é…ç½®æ–‡ä»¶å…¼å®¹**: æ”¯æŒæ—§çš„é…ç½®æ ¼å¼
        - âœ… **Cookieæ ¼å¼å…¼å®¹**: æ”¯æŒæ–°æ—§Cookieæ ¼å¼
        - âœ… **åŠŸèƒ½å®Œå…¨ä¿ç•™**: ä¿æŒæ‰€æœ‰åŸæœ‰åŠŸèƒ½
        
        ### ğŸš€ å¿«é€Ÿå¼€å§‹
        
        ```bash
        # æŸ¥çœ‹å¸®åŠ©
        ./xhs-toolkit --help
        
        # Cookieç®¡ç†
        ./xhs-toolkit cookie save
        ./xhs-toolkit cookie show
        ./xhs-toolkit cookie validate
        
        # é…ç½®ç®¡ç†
        ./xhs-toolkit config show
        ./xhs-toolkit config validate
        
        # æœåŠ¡å™¨ç®¡ç†
        ./xhs-toolkit server start
        ./xhs-toolkit server stop
        
        # ç³»ç»ŸçŠ¶æ€
        ./xhs-toolkit status
        
        # ç›´æ¥å‘å¸ƒ
        ./xhs-toolkit publish "æ ‡é¢˜" "å†…å®¹" --tags "æ ‡ç­¾1,æ ‡ç­¾2"
        ```
        
        ### ğŸ”§ æŠ€æœ¯æ”¹è¿›
        
        - **SOLIDåŸåˆ™**: å•ä¸€èŒè´£ã€å¼€é—­åŸåˆ™ã€ä¾èµ–å€’ç½®ç­‰
        - **ç±»å‹æç¤º**: å…¨é¢çš„type hintsæ”¯æŒ
        - **å¼‚æ­¥å¤„ç†**: async/awaitå¼‚æ­¥æ“ä½œ
        - **èµ„æºç®¡ç†**: è‡ªåŠ¨æ¸…ç†æµè§ˆå™¨èµ„æº
        - **é”™è¯¯å¤„ç†**: ç»Ÿä¸€çš„å¼‚å¸¸å¤„ç†ç³»ç»Ÿ
        - **æ—¥å¿—ç³»ç»Ÿ**: åŸºäºloguruçš„å®Œæ•´æ—¥å¿—
        - **Unicodeå…¼å®¹**: Windows GBKç¼–ç å¤„ç†
        
        ### ğŸ“¦ ä¸‹è½½è¯´æ˜
        
        | å¹³å° | æ–‡ä»¶ | è¯´æ˜ |
        |------|------|------|
        | ğŸ§ Linux | `xhs-toolkit-linux-x64.tar.gz` | é€‚ç”¨äºx64 Linuxç³»ç»Ÿ |
        | ğŸªŸ Windows | `xhs-toolkit-windows-x64.zip` | é€‚ç”¨äºx64 Windowsç³»ç»Ÿ |
        | ğŸ macOS | `xhs-toolkit-macos-x64.tar.gz` | é€‚ç”¨äºIntel Mac |
        
        ### ğŸ’¡ å¼€å‘è€…æ”¹è¿›
        
        - **æ¨¡å—åŒ–è®¾è®¡**: ä¾¿äºæ‰©å±•å’Œç»´æŠ¤
        - **æ¸…æ™°èŒè´£**: æ¯ä¸ªæ¨¡å—èŒè´£æ˜ç¡®
        - **å®Œæ•´æ–‡æ¡£**: ä»£ç è‡ªæ–‡æ¡£åŒ–
        - **æ˜“äºæµ‹è¯•**: æ¨¡å—ç‹¬ç«‹ä¾¿äºå•å…ƒæµ‹è¯•
        - **é…ç½®é©±åŠ¨**: è¡Œä¸ºå¯é…ç½®åŒ–
        

        
        ---
        
        **ğŸ¯ é‡æ„ç›®æ ‡ 100% è¾¾æˆï¼ä»£ç è´¨é‡å’Œå¯ç»´æŠ¤æ€§æ˜¾è‘—æå‡ï¼**
        EOF
        else
          # é€šç”¨çš„å‘å¸ƒè¯´æ˜æ¨¡æ¿
          cat > release-notes.md << EOF
        ## ğŸŒº å°çº¢ä¹¦MCPå·¥å…·åŒ… ${VERSION}
        
        > ğŸ“¦ **${RELEASE_TYPE} ç‰ˆæœ¬å‘å¸ƒ**
        
        ### âœ¨ ä¸»è¦ç‰¹æ€§
        - æ”¯æŒå°çº¢ä¹¦å›¾æ–‡ç¬”è®°è‡ªåŠ¨å‘å¸ƒ
        - å®Œæ•´çš„MCPåè®®æ”¯æŒï¼Œä¸Claude Desktopæ— ç¼é›†æˆ
        - æ™ºèƒ½Cookieç®¡ç†å’ŒéªŒè¯
        - å¤šå¹³å°äºŒè¿›åˆ¶æ–‡ä»¶æ”¯æŒ
        - æ¨¡å—åŒ–æ¡†æ¶ç»“æ„ï¼Œéµå¾ªSOLIDåŸåˆ™
        
        ### ğŸ“‹ åŠŸèƒ½æ¸…å•
        - [x] **å›¾æ–‡å‘å¸ƒ** - æ”¯æŒå‘å¸ƒæ–‡å­—å’Œå›¾ç‰‡ç¬”è®°
        - [x] **Cookieç®¡ç†** - å®‰å…¨è·å–ã€éªŒè¯å’Œç®¡ç†ç™»å½•å‡­è¯
        - [x] **MCPåè®®æ”¯æŒ** - ä¸AIå®¢æˆ·ç«¯å®Œç¾é›†æˆ
        - [x] **é…ç½®ç®¡ç†** - å®Œæ•´çš„é…ç½®ç³»ç»Ÿ
        - [x] **ç³»ç»ŸçŠ¶æ€** - ç³»ç»Ÿè¯Šæ–­å’ŒçŠ¶æ€æ£€æŸ¥
        - [ ] **è§†é¢‘å‘å¸ƒ** - æ”¯æŒå‘å¸ƒè§†é¢‘ç¬”è®°ï¼ˆå¼€å‘ä¸­ï¼‰
        
        ### ğŸš€ å¿«é€Ÿå¼€å§‹
        
        1. **ä¸‹è½½å¯¹åº”å¹³å°çš„æ–‡ä»¶**
        2. **è§£å‹åˆ°ä»»æ„ç›®å½•**
        3. **å¤åˆ¶é…ç½®æ–‡ä»¶**: \`cp env_example .env\`
        4. **ç¼–è¾‘é…ç½®**: å¡«å…¥Chromeå’ŒChromeDriverè·¯å¾„
        5. **è·å–ç™»å½•å‡­è¯**: \`./xhs-toolkit cookie save\`
        6. **å¯åŠ¨MCPæœåŠ¡**: \`./xhs-toolkit server start\`
        
        ### ğŸ“¦ ä¸‹è½½è¯´æ˜
        
        | å¹³å° | æ–‡ä»¶ | è¯´æ˜ |
        |------|------|------|
        | ğŸ§ Linux | \`xhs-toolkit-linux-x64.tar.gz\` | é€‚ç”¨äºx64 Linuxç³»ç»Ÿ |
        | ğŸªŸ Windows | \`xhs-toolkit-windows-x64.zip\` | é€‚ç”¨äºx64 Windowsç³»ç»Ÿ |
        | ğŸ macOS | \`xhs-toolkit-macos-x64.tar.gz\` | é€‚ç”¨äºIntel Mac |
        
        ---
        
        **Made with â¤ï¸ for content creators**
        EOF
        fi
        
        # å¦‚æœæ‰‹åŠ¨è¾“å…¥äº†é¢å¤–çš„å‘å¸ƒè¯´æ˜ï¼Œè¿½åŠ åˆ°æ–‡ä»¶æœ«å°¾
        if [ -n "${{ github.event.inputs.release_notes }}" ]; then
          echo "" >> release-notes.md
          echo "### ğŸ“ å…¶ä»–è¯´æ˜" >> release-notes.md
          echo "" >> release-notes.md
          echo "${{ github.event.inputs.release_notes }}" >> release-notes.md
        fi
        
    - name: ğŸ‰ åˆ›å»ºGitHub Release
      uses: ncipollo/release-action@v1
      with:
        tag: ${{ steps.version.outputs.version }}
        name: "å°çº¢ä¹¦MCPå·¥å…·åŒ… ${{ steps.version.outputs.version }}"
        bodyFile: release-notes.md
        draft: false
        prerelease: false
        artifacts: "release/*"
        token: ${{ secrets.GITHUB_TOKEN }}
        allowUpdates: true  # å…è®¸æ›´æ–°å·²å­˜åœ¨çš„release
        makeLatest: true    # æ ‡è®°ä¸ºæœ€æ–°ç‰ˆæœ¬
        generateReleaseNotes: false  # ä¸ä½¿ç”¨è‡ªåŠ¨ç”Ÿæˆï¼Œä½¿ç”¨æˆ‘ä»¬çš„è‡ªå®šä¹‰è¯´æ˜
        
    - name: ğŸ“Š å‘å¸ƒå®Œæˆé€šçŸ¥
      run: |
        echo "ğŸ‰ Release ${{ steps.version.outputs.version }} åˆ›å»ºæˆåŠŸ!"
        echo "ğŸ“¦ åŒ…å«ä»¥ä¸‹æ–‡ä»¶:"
        ls -la release/
        echo "ğŸ”— è®¿é—®åœ°å€: https://github.com/${{ github.repository }}/releases/tag/${{ steps.version.outputs.version }}" 